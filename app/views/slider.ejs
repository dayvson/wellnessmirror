<html>
	<head>
		<title>Wellness Mirror</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="">
		<meta name="author" content="Maria Paula Saba/Maxwell Dayvson da Silva">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css"/>
		<link href="/public/css/style.css" rel="stylesheet">
		<link href="/public/css/datepicker.css" rel="stylesheet">
		<style>

		</style>
	</head>
	<body>
		<div class="header">
		    <div class="wrapper">
		  	  <a href="#"><img src="/public/img/logo_small.png" title="Wellness Mirror"/></a>
		   	  <img src="<%= user.avatar %>" class="avatar pull-right" />
			  <ul class="nav nav-pills pull-right">
		          <li ><a href="#" class="selected">Home</a></li>
		          <li ><a href="#">About</a></li>
		          <li ><a href="/logout"> <%= user.nickname %> (logout)</a></li>
		      </ul>
		    </div> 
	 	 </div>
      	<div class="wrapper">
      	 	<div class="container">	
      	 		<p class = "choose_title">Choose time range</p>
		        <form>
					<div class="input-append" >
						<input  size="16" class="datep" data-date-format="yyyy-mm-dd" id="dataPickerField" type="text">
						<input size="16" class="datep" id="dataPickerField2" data-date-format="yyyy-mm-dd" type="text">
					</div>
				</form>
      	 		<p class = "choose_title">Choose visualization mode</p>
				<p><a class="btn submit highlight modes" href="#" role="button" id="overall">Overall mood</a></p>
				<p><a class="btn submit modes" href="#" role="button" id="percentage" >By Percentage</a></p>
				<div class = "result_overall" id="overall_container"  style="display:none;">
					<!--p>From 11/29/2013 to 11/29/2013, </p--> 
					<p style="display:block">your sleep and active levels are:</p>

					<p><span id="stateResult"></span></p>
				</div>	
				<div class="result_percentage" id="percentage_container" style="display:none;">
					<ul class="nav">
						<li><div class="legend bed"></div><span id="bed"></span> time in bed</li>
						<li><div class="legend sedentary"></div><span id="sedentary"></span>sedentary</li>
						<li><div class="legend light"></div><span id="light"></span>light active</li>
						<li><div class="legend fairly"></div><span id="fairly"></span>fairly active</li>
						<li><div class="legend very"></div><span id="very"></span>very active</li>
					</ul>
				</div>
				<div class="footer">
	        	<p>Â© Maria Paula Saba / Maxwell Dayvson da Silva 2013</p>
	      		</div>
			</div>
		</div>					



		<script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
		<script src="/public/js/bootstrap-datepicker.js"></script>
		<script>
			

			$(function(){
				var now = new Date();
				$(".datep").datepicker({format: 'yyyy-mm-dd'}).on('changeDate', function(ev) {
 						 $(this).datepicker('hide');
				}).val(now.getFullYear() + "-" + (now.getMonth()+1) + "-" + (now.getDate() <= 9 ? "0"+ now.getDate() : now.getDate()));

				$("#overall").on("click", function(elem){
					var data = {"date": $("#dataPickerField").val()};
					$("#percentage").removeClass("highlight");
					$(this).addClass("highlight");
					console.log("onchange");
			        $.ajax({
					  type: "POST",
					  url: "http://localhost:8080/sleep/date/select",
					  data: data,
					  success: function(data){
					  	$("#stateResult").html(data.sleep.toUpperCase() + " AND " + data.step.toUpperCase());
					  	$("#percentage_container").hide();
					  	$("#overall_container").show();
					  },
					  dataType: "json"
					});
				});
				$("#percentage").on("click", function(elem){
					var data = {"date": $("#dataPickerField").val()};
					$("#overall").removeClass("highlight");
					$(this).addClass("highlight");
					
			        $.ajax({
					  type: "GET",
					  url: "http://localhost:8080/activities/date/select/" + data["date"],
					  success: function(data){
					  	$("#percentage_container").show();
					  	$("#overall_container").hide();
					  	$("#bed").html(data.sleepTime);
					  	$("#sedentary").html(data.sedentary);
					  	$("#light").html(data.lightly);
					  	$("#fairly").html(data.fairly);
					  	$("#very").html(data.veryActive);
					  	$("#stateResult").empty().append(ul);
					  },
					  dataType: "json"
					});
				});
			});
			
		</script>
	</body>
	</body>
</html>